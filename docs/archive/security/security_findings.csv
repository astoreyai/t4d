ID,Severity,Category,Title,File,Line,Description,Remediation,Status
H-1,HIGH,Configuration,CORS Wildcard in Default Config,src/ww/core/config.py,645-647,"CORS can be set to wildcard (*) which allows any origin to make authenticated requests, enabling CSRF and data exfiltration","Add validator to reject wildcard in production, require HTTPS origins, update .env.example",Open
H-2,HIGH,Information Disclosure,Database Error Message Leakage,src/ww/api/routes/episodes.py,127-131,"Raw exception messages exposed in API responses may leak Neo4j URIs, database schema, internal paths, and stack traces","Sanitize all API error responses with generic messages, use error correlation IDs, log full details server-side only",Open
H-3,HIGH,Encryption,Production TLS Not Enforced,docker-compose.yml,25-26,"Neo4j and OTLP connections use plaintext by default, exposing credentials and memory data","Add production validator to require bolt+s:// URIs, enforce OTLP TLS, create production docker-compose template",Open
M-1,MEDIUM,Authentication,Weak Password Validation Insufficient,src/ww/core/config.py,32-80,"Passwords as short as 8 chars with only 2 character classes pass validation (e.g., 'Password1')","Increase minimum to 12 chars, check for common patterns, require 3 of 4 character classes",Open
M-2,MEDIUM,Input Validation,Session ID Allows Reserved IDs,src/ww/api/deps.py,23-49,"API accepts reserved session IDs like 'admin', 'system', 'root' which could cause conflicts","Set allow_reserved=False in validate_session_id(), add API-specific reserved list",Open
M-3,MEDIUM,DoS Protection,Rate Limiter Not Distributed,src/ww/mcp/gateway.py,36-114,"In-memory rate limiter ineffective with multiple API workers (100 req/min becomes 3200 with 32 workers)","Implement Redis-based distributed rate limiter or document single-worker limitation",Open
M-4,MEDIUM,Authentication,No API Key Authentication,src/ww/api/server.py,N/A,"No authentication mechanism exists; anyone with network access can create/read/delete memories","Implement API key authentication with X-API-Key header, require in production",Open
M-5,MEDIUM,Network Security,Docker Ports May Be Exposed,docker-compose.full.yml,N/A,"Need to verify full deployment doesn't bind database ports to 0.0.0.0","Audit docker-compose.full.yml and ensure localhost-only bindings",Open
M-6,MEDIUM,XSS Protection,No Content Security Policy Headers,src/ww/api/server.py,N/A,"FastAPI docs (/docs, /redoc) serve HTML without CSP headers, enabling potential XSS","Add SecurityHeadersMiddleware with CSP, X-Frame-Options, X-Content-Type-Options",Open
L-1,LOW,File Permissions,.env Permissions Not Enforced,src/ww/core/config.py,99-117,".env file permission check only warns, doesn't enforce 600 permissions in production","Fail on permissive permissions in production or auto-fix to mode 600",Open
L-2,LOW,Injection,Cypher Label Validation Relies on Whitelist,src/ww/storage/neo4j_store.py,41-81,"While validation is strong, f-string queries could be vulnerable if validation bypassed","Add paranoid regex check for Cypher metacharacters in addition to whitelist",Open
L-3,LOW,XSS Protection,XSS Sanitization Incomplete,src/ww/mcp/validation.py,265-299,"Removes dangerous patterns but doesn't HTML-encode; content could render unsafely in HTML clients","Document that API clients must HTML-escape content before rendering",Open
L-4,LOW,DoS Protection,Embedding Cache Has No Memory Limits,src/ww/embedding/service.py,N/A,"Config defines cache_size but need to verify LRU eviction is implemented","Verify EmbeddingService implements LRU eviction and TTL-based expiration",Open
L-5,LOW,Audit Logging,No Audit Trail for Sensitive Operations,src/ww/observability/logging.py,N/A,"No specific audit logging for session creation/deletion, bulk deletes, auth failures, rate limit violations","Add dedicated audit logger with structured events including IP, user agent, session ID",Open
L-6,LOW,Container Security,Docker Containers Run as Root,Dockerfile,N/A,"No USER directive in Dockerfile; containers run as root by default","Add non-root user in Dockerfile with proper file ownership",Open
L-7,LOW,DoS Protection,No Request Size Limits,src/ww/api/server.py,N/A,"No overall request size limit; could cause DoS with large payloads","Add RequestSizeLimitMiddleware with 5MB default limit",Open
L-8,LOW,Timeout,No Timeout on External LLM Calls,src/ww/extraction/entity_extractor.py,N/A,"Need to verify LLM client enforces extraction_llm_timeout config","Verify AsyncOpenAI client initialized with timeout parameter",Open
I-1,INFO,Testing,Password Validation Test Mode Bypass,src/ww/core/config.py,664-668,"WW_TEST_MODE allows weak passwords; ensure never used in production","Add warning log when test mode enabled, document as dev/test only",Open
I-2,INFO,Configuration,Hardcoded Rate Limits,src/ww/api/deps.py,20,"Rate limits hardcoded to 100 req/min instead of configurable","Make rate limits configurable via settings",Open
I-3,INFO,Database Security,Neo4j APOC Unrestricted,docker-compose.yml,17-18,"APOC plugin enabled with unrestricted procedures; could allow file I/O if credentials compromised","Restrict to needed procedures: apoc.meta.*, apoc.create.*",Open
I-4,INFO,Input Validation,Session ID Length May Block JWTs,src/ww/mcp/validation.py,519,"128-char limit may be insufficient for JWT session IDs (typical 200-500 chars)","Increase limit to 512 if JWT auth is planned",Open
I-5,INFO,Metrics Security,Prometheus Metrics May Leak Data,src/ww/observability/prometheus.py,N/A,"/metrics endpoint may leak request rates, session IDs in labels","Sanitize labels (hash session IDs), bind to localhost only",Open
